)
View(df_total_aux)
library(lubridate)
library(tidyverse)
library(dplyr)
library(readr)
library(mem)
# Loading data from Santos ################################
df_santos <- read_csv2("RJ/330455_total_new.csv")
df_santos <- df_santos %>% mutate(EPI_WEEK = as.numeric(WEEK_PRI),
EPI_YEAR = as.numeric(YEAR_PRI)) %>%
select(EPI_WEEK, EPI_YEAR, CASES)
df_santos <- df_santos %>% mutate(tplot = EPI_YEAR + (EPI_WEEK/52))
df_santos <- df_santos %>% select(EPI_YEAR, EPI_WEEK, tplot, CASES)
df_santos <- df_santos %>% arrange(tplot)
df_santos
# Plotting the whole series ##############################
ggplot(df_santos, aes(x = tplot, y = CASES)) + geom_line() + geom_point()
# Plotting all seasons ######################################
p <- ggplot()
for(year in unique(df_santos$EPI_YEAR)){
df_aux <- df_santos %>% filter(EPI_YEAR == year)
p <- p + geom_point(data = df_aux, aes(x = EPI_WEEK, y = CASES)) +
geom_line(data = df_aux, aes(x = EPI_WEEK, y = CASES))
}
# Plotting while normalizing ###############################
p <- ggplot()
for(year in unique(df_santos$EPI_YEAR)){
df_aux <- df_santos %>% filter(EPI_YEAR == year)
norm_fact <- max(df_aux)
p <- p + geom_point(data = df_aux, aes(x = EPI_WEEK, y = CASES/norm_fact)) +
geom_line(data = df_aux, aes(x = EPI_WEEK, y = CASES/norm_fact))
}
p
# Plotting year by year ####################################
for(year in unique(df_santos$EPI_YEAR)){
p <- ggplot()
df_aux <- df_santos %>% filter(EPI_YEAR == year)
norm_fact <- max(df_aux)
p <- p + geom_point(data = df_aux, aes(x = EPI_WEEK, y = CASES)) +
geom_line(data = df_aux, aes(x = EPI_WEEK, y = CASES)) + ggtitle(year)
print(p)
}
# Filtering some years only ###################################
df_santos <- df_santos %>% filter(EPI_YEAR >= 2001) %>% filter(EPI_YEAR <= 2021)
df_santos <- df_santos %>% select(EPI_YEAR, EPI_WEEK, CASES)
# Calculating weekly rate of cases per 100k inhabitants ############################
pop <- read.csv2('RJ/pop_RJ.csv')
df_santos <- df_santos %>% left_join(pop, by = join_by(EPI_YEAR == Ano))
df_santos['CASES_100K'] <- (df_santos['CASES']/df_santos['Pop_residente'])*(10**5)
df_santos_serie <- df_santos
# Putting this into form for memmodel #########################################
df_santos <- df_santos %>% filter(EPI_WEEK <= 40)
df_santos <- df_santos %>% select(EPI_YEAR, EPI_WEEK, CASES_100K)
df_santos <- df_santos %>% pivot_wider(names_from = EPI_YEAR, values_from = CASES_100K)
df_santos[is.na(df_santos)] <- 0
rm(df_aux,p,pop)
df_santos <- df_santos %>% select(!c(EPI_WEEK))
View(df_santos)
View(df_santos)
library(lubridate)
library(tidyverse)
library(dplyr)
library(readr)
library(mem)
library(lubridate)
library(tidyverse)
library(dplyr)
library(readr)
library(mem)
# Loading data ##############################################
load('SP/dataset_SP.RData')
df_total_aux <- df_total
df_total_aux <- df_total_aux %>% ungroup() %>% mutate(CASES = lead(CASES, 13),
EPI_WEEK = lead(EPI_WEEK, 13),
EPI_YEAR = lead(EPI_YEAR, 13),
tplot = lead(tplot, 13),
rh_max = lead(rh_max, 13),
rh_min = lead(rh_min, 13),
t_min = lead(t_min, 4),
p_total = lead(p_total, 2),
LAMBDA = lead(LAMBDA, 7))
df_total_aux <- df_total_aux %>%
mutate(rh_max_lag = rh_max,
rh_min_lag = rh_min,
t_min_lag = t_min,
t_max_lag = t_max,
p_total_lag = p_total,
LAMBDA_lag = LAMBDA) %>%
select(EPI_YEAR, EPI_WEEK, tplot, CASES, rh_max_lag, rh_min_lag,
t_min_lag, t_max_lag, p_total_lag LAMBDA_lag)
df_total_aux <- df_total_aux %>%
mutate(rh_max_lag = rh_max,
rh_min_lag = rh_min,
t_min_lag = t_min,
t_max_lag = t_max,
p_total_lag = p_total,
LAMBDA_lag = LAMBDA) %>%
select(EPI_YEAR, EPI_WEEK, tplot, CASES, rh_max_lag, rh_min_lag,
t_min_lag, t_max_lag, p_total_lagm LAMBDA_lag)
df_total_aux <- df_total_aux %>%
mutate(rh_max_lag = rh_max,
rh_min_lag = rh_min,
t_min_lag = t_min,
t_max_lag = t_max,
p_total_lag = p_total,
LAMBDA_lag = LAMBDA) %>%
select(EPI_YEAR, EPI_WEEK, tplot, CASES, rh_max_lag, rh_min_lag,
t_min_lag, t_max_lag, p_total_lag, LAMBDA_lag)
# Calculating with size of the population ################################
pop <- read.csv2('SP/pop_SP.csv')
df_total_aux <- df_total_aux %>% left_join(pop, by = join_by(EPI_YEAR == Ano))
df_total_aux <- df_total_aux %>% mutate(CASES_100K = (CASES/Pop_residente)*(10**5))
df_total_aux <- df_total_aux %>% select(!Pop_residente)
df_total_aux <- df_total_aux %>% select(!CASES)
df_total_aux <- df_total_aux %>% drop_na()
rm(pop, df_total)
# Calculating with the epidemic thresholds #################################
thr_pre <- 5.2
thr_high <- 16.15
df_total_aux <- df_total_aux %>% mutate(label =
case_when(CASES_100K <= thr_pre ~ 'Pre',
CASES_100K > thr_pre & CASES_100K <= thr_high ~ 'Epi',
CASES_100K > thr_high ~ 'High')
)
# Saving dataset for ML ##################################################
save(df_total_aux, file = 'SP/dataset_ML_SP_CC.RData')
write_csv(df_total_aux, 'SP/dataset_ML_SP_CC.csv')
library(lubridate)
library(tidyverse)
library(dplyr)
library(readr)
library(mem)
# Loading data from Santos ################################
df_santos <- read_csv2("RJ/330455_total_new.csv")
df_santos <- df_santos %>% mutate(EPI_WEEK = as.numeric(WEEK_PRI),
EPI_YEAR = as.numeric(YEAR_PRI)) %>%
select(EPI_WEEK, EPI_YEAR, CASES)
df_santos <- df_santos %>% mutate(tplot = EPI_YEAR + (EPI_WEEK/52))
df_santos <- df_santos %>% select(EPI_YEAR, EPI_WEEK, tplot, CASES)
df_santos <- df_santos %>% arrange(tplot)
df_santos
# Plotting the whole series ##############################
ggplot(df_santos, aes(x = tplot, y = CASES)) + geom_line() + geom_point()
# Plotting all seasons ######################################
p <- ggplot()
for(year in unique(df_santos$EPI_YEAR)){
df_aux <- df_santos %>% filter(EPI_YEAR == year)
p <- p + geom_point(data = df_aux, aes(x = EPI_WEEK, y = CASES)) +
geom_line(data = df_aux, aes(x = EPI_WEEK, y = CASES))
}
# Plotting while normalizing ###############################
p <- ggplot()
for(year in unique(df_santos$EPI_YEAR)){
df_aux <- df_santos %>% filter(EPI_YEAR == year)
norm_fact <- max(df_aux)
p <- p + geom_point(data = df_aux, aes(x = EPI_WEEK, y = CASES/norm_fact)) +
geom_line(data = df_aux, aes(x = EPI_WEEK, y = CASES/norm_fact))
}
p
# Plotting year by year ####################################
for(year in unique(df_santos$EPI_YEAR)){
p <- ggplot()
df_aux <- df_santos %>% filter(EPI_YEAR == year)
norm_fact <- max(df_aux)
p <- p + geom_point(data = df_aux, aes(x = EPI_WEEK, y = CASES)) +
geom_line(data = df_aux, aes(x = EPI_WEEK, y = CASES)) + ggtitle(year)
print(p)
}
# Filtering some years only ###################################
df_santos <- df_santos %>% filter(EPI_YEAR >= 2001) %>% filter(EPI_YEAR <= 2021)
df_santos <- df_santos %>% select(EPI_YEAR, EPI_WEEK, CASES)
# Calculating weekly rate of cases per 100k inhabitants ############################
pop <- read.csv2('RJ/pop_RJ.csv')
df_santos <- df_santos %>% left_join(pop, by = join_by(EPI_YEAR == Ano))
df_santos['CASES_100K'] <- (df_santos['CASES']/df_santos['Pop_residente'])*(10**5)
df_santos_serie <- df_santos
# Putting this into form for memmodel #########################################
df_santos <- df_santos %>% filter(EPI_WEEK <= 40)
df_santos <- df_santos %>% select(EPI_YEAR, EPI_WEEK, CASES_100K)
df_santos <- df_santos %>% pivot_wider(names_from = EPI_YEAR, values_from = CASES_100K)
df_santos[is.na(df_santos)] <- 0
rm(df_aux,p,pop)
df_santos <- df_santos %>% select(!c(EPI_WEEK))
# Passing this through the memmodel ##########################################
dengue.memmodel <- memmodel(df_santos, i.season = 20)
summary(dengue.memmodel)
plot(dengue.memmodel)
gc()
library(lubridate)
library(tidyverse)
library(dplyr)
library(readr)
library(mem)
# Loading data from Santos ################################
df_santos <- read_csv2("RJ/330455_total_new.csv")
df_santos <- df_santos %>% mutate(EPI_WEEK = as.numeric(WEEK_PRI),
EPI_YEAR = as.numeric(YEAR_PRI)) %>%
select(EPI_WEEK, EPI_YEAR, CASES)
df_santos <- df_santos %>% mutate(tplot = EPI_YEAR + (EPI_WEEK/52))
df_santos <- df_santos %>% select(EPI_YEAR, EPI_WEEK, tplot, CASES)
df_santos <- df_santos %>% arrange(tplot)
df_santos
# Plotting the whole series ##############################
ggplot(df_santos, aes(x = tplot, y = CASES)) + geom_line() + geom_point()
# Plotting all seasons ######################################
p <- ggplot()
for(year in unique(df_santos$EPI_YEAR)){
df_aux <- df_santos %>% filter(EPI_YEAR == year)
p <- p + geom_point(data = df_aux, aes(x = EPI_WEEK, y = CASES)) +
geom_line(data = df_aux, aes(x = EPI_WEEK, y = CASES))
}
# Plotting while normalizing ###############################
p <- ggplot()
for(year in unique(df_santos$EPI_YEAR)){
df_aux <- df_santos %>% filter(EPI_YEAR == year)
norm_fact <- max(df_aux)
p <- p + geom_point(data = df_aux, aes(x = EPI_WEEK, y = CASES/norm_fact)) +
geom_line(data = df_aux, aes(x = EPI_WEEK, y = CASES/norm_fact))
}
p
# Plotting year by year ####################################
for(year in unique(df_santos$EPI_YEAR)){
p <- ggplot()
df_aux <- df_santos %>% filter(EPI_YEAR == year)
norm_fact <- max(df_aux)
p <- p + geom_point(data = df_aux, aes(x = EPI_WEEK, y = CASES)) +
geom_line(data = df_aux, aes(x = EPI_WEEK, y = CASES)) + ggtitle(year)
print(p)
}
# Filtering some years only ###################################
df_santos <- df_santos %>% filter(EPI_YEAR >= 2001) %>% filter(EPI_YEAR <= 2021)
df_santos <- df_santos %>% select(EPI_YEAR, EPI_WEEK, CASES)
# Calculating weekly rate of cases per 100k inhabitants ############################
pop <- read.csv2('RJ/pop_RJ.csv')
df_santos <- df_santos %>% left_join(pop, by = join_by(EPI_YEAR == Ano))
df_santos['CASES_100K'] <- (df_santos['CASES']/df_santos['Pop_residente'])*(10**5)
df_santos_serie <- df_santos
# Putting this into form for memmodel #########################################
df_santos <- df_santos %>% filter(EPI_WEEK <= 40)
df_santos <- df_santos %>% select(EPI_YEAR, EPI_WEEK, CASES_100K)
df_santos <- df_santos %>% pivot_wider(names_from = EPI_YEAR, values_from = CASES_100K)
df_santos[is.na(df_santos)] <- 0
rm(df_aux,p,pop)
df_santos <- df_santos %>% select(!c(EPI_WEEK))
# Passing this through the memmodel ##########################################
dengue.memmodel <- memmodel(df_santos, i.season = 20)
summary(dengue.memmodel)
plot(dengue.memmodel)
gc()
library(lubridate)
library(tidyverse)
library(dplyr)
library(readr)
library(mem)
# Loading data from Santos ################################
df_santos <- read_csv2("RJ/330455_total_new.csv")
df_santos <- df_santos %>% mutate(EPI_WEEK = as.numeric(WEEK_PRI),
EPI_YEAR = as.numeric(YEAR_PRI)) %>%
select(EPI_WEEK, EPI_YEAR, CASES)
df_santos <- df_santos %>% mutate(tplot = EPI_YEAR + (EPI_WEEK/52))
df_santos <- df_santos %>% select(EPI_YEAR, EPI_WEEK, tplot, CASES)
df_santos <- df_santos %>% arrange(tplot)
df_santos
# Plotting the whole series ##############################
ggplot(df_santos, aes(x = tplot, y = CASES)) + geom_line() + geom_point()
# Plotting all seasons ######################################
p <- ggplot()
for(year in unique(df_santos$EPI_YEAR)){
df_aux <- df_santos %>% filter(EPI_YEAR == year)
p <- p + geom_point(data = df_aux, aes(x = EPI_WEEK, y = CASES)) +
geom_line(data = df_aux, aes(x = EPI_WEEK, y = CASES))
}
# Plotting while normalizing ###############################
p <- ggplot()
for(year in unique(df_santos$EPI_YEAR)){
df_aux <- df_santos %>% filter(EPI_YEAR == year)
norm_fact <- max(df_aux)
p <- p + geom_point(data = df_aux, aes(x = EPI_WEEK, y = CASES/norm_fact)) +
geom_line(data = df_aux, aes(x = EPI_WEEK, y = CASES/norm_fact))
}
p
# Plotting year by year ####################################
for(year in unique(df_santos$EPI_YEAR)){
p <- ggplot()
df_aux <- df_santos %>% filter(EPI_YEAR == year)
norm_fact <- max(df_aux)
p <- p + geom_point(data = df_aux, aes(x = EPI_WEEK, y = CASES)) +
geom_line(data = df_aux, aes(x = EPI_WEEK, y = CASES)) + ggtitle(year)
print(p)
}
# Filtering some years only ###################################
df_santos <- df_santos %>% filter(EPI_YEAR >= 2001) %>% filter(EPI_YEAR <= 2021)
df_santos <- df_santos %>% select(EPI_YEAR, EPI_WEEK, CASES)
# Calculating weekly rate of cases per 100k inhabitants ############################
pop <- read.csv2('RJ/pop_RJ.csv')
df_santos <- df_santos %>% left_join(pop, by = join_by(EPI_YEAR == Ano))
df_santos['CASES_100K'] <- (df_santos['CASES']/df_santos['Pop_residente'])*(10**5)
df_santos_serie <- df_santos
# Putting this into form for memmodel #########################################
df_santos
# Putting this into form for memmodel #########################################
df_santos['season'] <- 0
View(df_santos)
# Putting this into form for memmodel #########################################
df_santos <- df_santos %>% mutate(season = ifelse(EPI_WEEK <= 40, EPI_YEAR, EPI_YEAR - 1))
#df_santos <- df_santos %>% filter(EPI_WEEK <= 40)
df_santos <- df_santos %>% select(season, EPI_WEEK, CASES_100K)
df_santos <- df_santos %>% pivot_wider(names_from = season, values_from = CASES_100K)
df_santos[is.na(df_santos)] <- 0
rm(df_aux,p,pop)
df_santos <- df_santos %>% select(!c(EPI_WEEK))
# Passing this through the memmodel ##########################################
dengue.memmodel <- memmodel(df_santos, i.season = 20)
summary(dengue.memmodel)
plot(dengue.memmodel)
# Plotting the whole thing ####################################################
thr_preepi <- 17.42
thr_medium <- 2.35
thr_high <- 52.54
thr_vhigh <- 207.42
# Plotting the whole thing ####################################################
thr_preepi <- 17.42
thr_medium <- 3.30
thr_high <- 53.52
thr_vhigh <- 183.44
df_santos_serie <- df_santos_serie %>% mutate(tplot = EPI_YEAR + EPI_WEEK/52)
ggplot(df_santos_serie, aes(x = tplot, y = CASES_100K)) + geom_line() +
geom_point() + geom_hline(yintercept = thr_preepi, color = 'red') +
geom_hline(yintercept = thr_high, color = 'blue') +
theme_bw() +
xlab('Year') +
ylab('Cases per 100.000 inhabitants') +
annotate("text", x = 2019-0.2, y = thr_preepi + 10, label="Pre-Epidemic", size = 3, color = 'red') +
annotate("text", x = 2019-0.2, y = thr_high + 10, label="High", size = 3, color = 'blue')
library(lubridate)
library(tidyverse)
library(dplyr)
library(readr)
library(mem)
# Loading data ##############################################
load('RJ/dataset_RJ.RData')
# Using CCM results ##############################################
df_total_aux <- df_total
df_total_aux <- df_total_aux %>% ungroup() %>% mutate(CASES = lead(CASES, 15),
EPI_WEEK = lead(EPI_WEEK, 15),
EPI_YEAR = lead(EPI_YEAR, 15),
tplot = lead(tplot, 15),
rh_max = lead(rh_max, 1),
rh_min = lead(rh_min, 3),
t_min = lead(t_min, 6),
t_max = lead(t_max, 5),
LAMBDA = lead(LAMBDA, 15))
df_total_aux <- df_total_aux %>%
mutate(rh_max_lag = rh_max,
rh_min_lag = rh_min,
t_min_lag = t_min,
t_max_lag = t_max,
LAMBDA_lag = LAMBDA,
p_total_lag = p_total) %>%
select(EPI_YEAR, EPI_WEEK, tplot, CASES, rh_max_lag, rh_min_lag,
t_min_lag, t_max_lag, LAMBDA_lag, p_total_lag)
# Calculating with size of the population ################################
pop <- read.csv2('RJ/pop_RJ.csv')
df_total_aux <- df_total_aux %>% left_join(pop, by = join_by(EPI_YEAR == Ano))
df_total_aux <- df_total_aux %>% mutate(CASES_100K = (CASES/Pop_residente)*(10**5))
df_total_aux <- df_total_aux %>% select(!Pop_residente)
df_total_aux <- df_total_aux %>% select(!CASES)
df_total_aux <- df_total_aux %>% drop_na()
rm(pop, df_total)
# Calculating with the epidemic thresholds #################################
thr_pre <- 17.42
thr_high <- 53.52
df_total_aux <- df_total_aux %>% mutate(label =
case_when(CASES_100K <= thr_pre ~ 'Pre',
CASES_100K > thr_pre & CASES_100K <= thr_high ~ 'Epi',
CASES_100K > thr_high ~ 'High')
)
# Saving dataset for ML ##################################################
save(df_total_aux, file = 'RJ/dataset_ML_RJ.RData')
write_csv(df_total_aux, 'RJ/dataset_ML_RJ.csv')
library(lubridate)
library(tidyverse)
library(dplyr)
library(readr)
library(mem)
# Loading data ##############################################
load('RJ/dataset_RJ.RData')
# Using CCM results ##############################################
df_total_aux <- df_total
df_total_aux <- df_total_aux %>% ungroup() %>% mutate(CASES = lead(CASES, 15),
EPI_WEEK = lead(EPI_WEEK, 15),
EPI_YEAR = lead(EPI_YEAR, 15),
tplot = lead(tplot, 15),
rh_max = lead(rh_max, 1),
rh_min = lead(rh_min, 3),
t_min = lead(t_min, 6),
t_max = lead(t_max, 5),
LAMBDA = lead(LAMBDA, 15))
df_total_aux <- df_total_aux %>%
mutate(rh_max_lag = rh_max,
rh_min_lag = rh_min,
t_min_lag = t_min,
t_max_lag = t_max,
LAMBDA_lag = LAMBDA,
p_total_lag = p_total) %>%
select(EPI_YEAR, EPI_WEEK, tplot, CASES, rh_max_lag, rh_min_lag,
t_min_lag, t_max_lag, LAMBDA_lag, p_total_lag)
# Calculating with size of the population ################################
pop <- read.csv2('RJ/pop_RJ.csv')
df_total_aux <- df_total_aux %>% left_join(pop, by = join_by(EPI_YEAR == Ano))
df_total_aux <- df_total_aux %>% mutate(CASES_100K = (CASES/Pop_residente)*(10**5))
df_total_aux <- df_total_aux %>% select(!Pop_residente)
df_total_aux <- df_total_aux %>% select(!CASES)
df_total_aux <- df_total_aux %>% drop_na()
rm(pop, df_total)
View(df_total_aux)
library(lubridate)
library(tidyverse)
library(dplyr)
library(readr)
library(mem)
# Loading data from Santos ################################
df_santos <- read_csv2("RJ/330455_total_new.csv")
df_santos <- df_santos %>% mutate(EPI_WEEK = as.numeric(WEEK_PRI),
EPI_YEAR = as.numeric(YEAR_PRI)) %>%
select(EPI_WEEK, EPI_YEAR, CASES)
df_santos <- df_santos %>% mutate(tplot = EPI_YEAR + (EPI_WEEK/52))
df_santos <- df_santos %>% select(EPI_YEAR, EPI_WEEK, tplot, CASES)
df_santos <- df_santos %>% arrange(tplot)
df_santos
# Plotting the whole series ##############################
ggplot(df_santos, aes(x = tplot, y = CASES)) + geom_line() + geom_point()
# Plotting all seasons ######################################
p <- ggplot()
for(year in unique(df_santos$EPI_YEAR)){
df_aux <- df_santos %>% filter(EPI_YEAR == year)
p <- p + geom_point(data = df_aux, aes(x = EPI_WEEK, y = CASES)) +
geom_line(data = df_aux, aes(x = EPI_WEEK, y = CASES))
}
# Plotting while normalizing ###############################
p <- ggplot()
for(year in unique(df_santos$EPI_YEAR)){
df_aux <- df_santos %>% filter(EPI_YEAR == year)
norm_fact <- max(df_aux)
p <- p + geom_point(data = df_aux, aes(x = EPI_WEEK, y = CASES/norm_fact)) +
geom_line(data = df_aux, aes(x = EPI_WEEK, y = CASES/norm_fact))
}
p
# Plotting year by year ####################################
for(year in unique(df_santos$EPI_YEAR)){
p <- ggplot()
df_aux <- df_santos %>% filter(EPI_YEAR == year)
norm_fact <- max(df_aux)
p <- p + geom_point(data = df_aux, aes(x = EPI_WEEK, y = CASES)) +
geom_line(data = df_aux, aes(x = EPI_WEEK, y = CASES)) + ggtitle(year)
print(p)
}
# Filtering some years only ###################################
df_santos <- df_santos %>% filter(EPI_YEAR >= 2001) %>% filter(EPI_YEAR <= 2021)
df_santos <- df_santos %>% select(EPI_YEAR, EPI_WEEK, CASES)
View(df_total_aux)
library(lubridate)
library(tidyverse)
library(dplyr)
library(readr)
library(mem)
library(lubridate)
library(tidyverse)
library(dplyr)
library(readr)
library(mem)
# Loading data ##############################################
load('RJ/dataset_RJ.RData')
df_total_aux <- df_total
df_total_aux <- df_total_aux %>% ungroup() %>% mutate(CASES = lead(CASES, 18),
EPI_WEEK = lead(EPI_WEEK, 18),
EPI_YEAR = lead(EPI_YEAR, 18),
tplot = lead(tplot, 18),
rh_max = lead(rh_max, 0),
rh_min = lead(rh_min, 16),
t_min = lead(t_min, 12),
t_max = lead(t_max, 8),
LAMBDA = lead(LAMBDA, 15))
df_total_aux <- df_total_aux %>%
mutate(rh_max_lag = rh_max,
rh_min_lag = rh_min,
t_min_lag = t_min,
t_max_lag = t_max,
LAMBDA_lag = LAMBDA,
p_total_lag = p_total) %>%
select(EPI_YEAR, EPI_WEEK, tplot, CASES, rh_max_lag, rh_min_lag,
t_min_lag, t_max_lag, LAMBDA_lag, p_total_lag)
# Calculating with size of the population ################################
pop <- read.csv2('RJ/pop_RJ.csv')
df_total_aux <- df_total_aux %>% left_join(pop, by = join_by(EPI_YEAR == Ano))
df_total_aux <- df_total_aux %>% mutate(CASES_100K = (CASES/Pop_residente)*(10**5))
df_total_aux <- df_total_aux %>% select(!Pop_residente)
df_total_aux <- df_total_aux %>% select(!CASES)
df_total_aux <- df_total_aux %>% drop_na()
rm(pop, df_total)
# Calculating with the epidemic thresholds #################################
thr_pre <- 17.42
thr_high <- 53.52
df_total_aux <- df_total_aux %>% mutate(label =
case_when(CASES_100K <= thr_pre ~ 'Pre',
CASES_100K > thr_pre & CASES_100K <= thr_high ~ 'Epi',
CASES_100K > thr_high ~ 'High')
)
# Saving dataset for ML ##################################################
save(df_total_aux, file = 'RJ/dataset_ML_RJ_CC.RData')
write_csv(df_total_aux, 'RJ/dataset_ML_RJ_CC.csv')
